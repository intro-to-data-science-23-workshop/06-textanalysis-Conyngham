---
title: "Starting with Quanteda"
author: "Aranxa Marquez"
date: "2023-10-09"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
## Install quanteda package
# install.packages("quanteda") 

library(quanteda)

```

```{r}
library(rvest)
library(stringr)
library(tidyverse)
library(quanteda)

```

```{r initialise2, warning=FALSE}
library(quanteda.textstats)
```

## Try it out! Comparing political discourses
Now we're going to give you an example where you can apply this for on of the most used cases: analysing political discourses.

**Step 1**. Scraping a discourse
To practice you can use the http://obamaspeeches.com website to explore on his best* speeches.

*According to the webpage creators.

```{r}
obama_speeches <- "http://obamaspeeches.com/P-Obama-Inaugural-Speech-Inauguration.htm"
obama_inaugural <- read_html(obama_inaugural_speech)

```

With Selector Gadget we identify the structure in the html containing the text. Copy it direct from the bar, do not click on the xpath function. 
```{r}
inaugural_speech_container <- obama_inaugural |>  html_nodes("br+ table font+ font")

# Extract the text from the container
inaugural_speech_text <- html_text(inaugural_speech_container)

# Print the speech text
cat(inaugural_speech_text, sep = "\n")

```

You can have a look here on the different speeches you would like to work on later that are available on the website.
```{r}

titles_speeches <- obama_inaugural |> 
  html_nodes("table p")

titles_speeches <- sapply(titles_speeches, html_text, USE.NAMES = FALSE)

cat(titles_speeches , sep = "\n")
```


Following on the functions you just learned, you can now explore with the 'corpus' and the 'token' functions how this speech is structured.
```{r}

inaugural_df <- rbind(inaugural_speech_text)
inaugural_speech_corpus <- corpus(inaugural_df )
inaugural_speech_tokens <- tokens(inaugural_speech_corpus)

summary(inaugural_speech_corpus)

```
We transform the speech into a document-feature matrix (dmf)
```{r}

inaugural_speech_dfm <- dfm(inaugural_speech_tokens)

print(inaugural_speech_dfm)

```

```{r}
topfeatures(inaugural_speech_dfm )
```


```{r}

inaugural_speech_tokens <- tokens(inaugural_speech_corpus, remove_punct = TRUE, remove_numbers = TRUE, remove_symbols = TRUE)

inaugural_speech_tokens <- tokens_remove(inaugural_speech_tokens, stopwords("en"))
speech_tokens <-  tokens_remove(inaugural_speech_tokens, c('the','and', 'that','to', 'can', 'must'))

inaugural_speech_dfm <- dfm(inaugural_speech_tokens)

topfeatures(inaugural_speech_dfm)
```



We'll compare it with another speech, this time with "An Honest Government - A Hopeful Future" which Obama hold at the University of Nairobi.

```{r}

```


```{r}



```


